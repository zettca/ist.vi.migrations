(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{102:function(e,t,n){e.exports=n(202)},172:function(e,t,n){},176:function(e,t,n){},200:function(e,t,n){},202:function(e,t,n){"use strict";n.r(t);var a=n(40),r=n(6),c=n.n(r),o=n(1),i=n.n(o),l=n(7),u=n.n(l),s=n(16),d=n(20),p=n(21),f=n(24),v=n(22),h=n(23),m=n(100),g=n(4);var b=9,y={map:g.s[b],selection:g.t.slice(2)};function j(e,t){return c.a.get("isEmigration")?e.WORLD[t]:e[t].Total}function O(e){return c.a.get("codeToName")[e]}function x(e){var t={};for(var n in e){var a=Number(e[n]);isNaN(a)||0===a||(t[n]=a)}return t}function k(e){return document.getElementById(e)}function w(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{width:400,height:400},n=arguments.length>2?arguments[2]:void 0,a=g.u(e).append("svg").attr("width",t.width).attr("height",t.height);return void 0!==n?a.append("g").attr("class","main").attr("transform","translate(".concat(n.left||0,",").concat(n.top||0,")")):a}var A,C,E,S,R,F={draw:function(e,t){var n=document.querySelector(e),a=[n.clientWidth,n.clientHeight],r=a[0],c=a[1];A=w(e,{width:r,height:c}),S=.5*Math.min(r,c),R=S-20,E=t,A.attr("viewBox",[-r/2,-c/2,r,c]),A.append("g").attr("class","nodes"),A.append("g").attr("class","arcs"),I()},update:I};function N(){C=c.a.get("selectedCountries");var e=c.a.get("isEmigration"),t=c.a.get("year")||2010,n=[];return C.forEach(function(a){n.push(C.map(function(n){return function(n,a){var r;try{r=e?E[t][a][n]:E[t][n][a]}catch(c){r=0}return r||0}(a,n)}))}),n}function I(){console.log("updating chord...");var e=A.select(".nodes"),t=A.select(".arcs");e.selectAll(".node").remove(),t.selectAll(".arc").remove();var n=g.d().padAngle(.02)(N()),r=g.o().radius(R),o=g.q().domain(g.n(9)).range(y.selection),i=g.a().innerRadius(R).outerRadius(S);e.selectAll("g").data(n.groups).enter().append("g").attr("class","node").append("path").attr("fill",function(e,t){return o(t)}).attr("stroke",function(e,t){return o(t)}).attr("d",i).on("mouseover",function(e,n){var a=t.selectAll(".arc");a.classed("fade",function(e){return e.source.index!==n&&e.target.index!==n}),a.classed("show",function(e){return e.source.index===n})}).on("mouseout",function(e,n){t.selectAll(".arc.show").classed("show",!1),t.selectAll(".arc.fade").classed("fade",!1)}).append("title").text(function(e){return"".concat(O(C[e.index]),": ").concat(g.g("~s")(e.value))}),t.selectAll("path").data(n).enter().append("path").attr("class","arc").attr("d",r).attr("fill",function(e){return o(e.target.index)}).append("title").text(function(e){return function(e){var t=c.a.get("isEmigration")?[e.source,e.target]:[e.target,e.source],n=[e.source,e.target],r=t.map(function(e){return O(C[e.index])}),o=Object(a.a)(r,2),i=o[0],l=o[1],u=n.map(function(e){return g.g("~s")(e.value)}),s=Object(a.a)(u,2),d=s[0],p=s[1];return"".concat(i," > ").concat(l,": ").concat(d,"\n").concat(l," > ").concat(i,": ").concat(p)}(e)})}var P,B,D,T,H,W,q={draw:function(e,t,n,a){var r=document.querySelector(e);B={width:r.clientWidth,height:r.clientHeight},P=w(e,B,M),H=t,W=a,T=n,L()},update:L},M={top:10,right:20,bottom:20,left:40},V=["GDP per capita","Social support","Healthy life expectancy","Freedom to make life choices","Perceptions of corruption"];function J(){var e={};return T.forEach(function(t){void 0===e[t.country]&&(e[t.country]=[]),e[t.country].push(function(e){var t={};for(var n in e){var a=Number(e[n]);t[n]=a||e[n]}return t}(t))}),e}function L(){console.log("updating graph...");var e=B.width-M.left-M.right,t=B.height-M.top-M.bottom;D=c.a.get("selectedCountries");var n=function(){var e={};if(!D||0===D.length)return[];var t=!0,n=!1,a=void 0;try{for(var r,c=D[Symbol.iterator]();!(t=(r=c.next()).done);t=!0){var o=r.value,i=[];for(var l in H){var u=H[l];if(void 0!==u[o]){var s=Number(j(u,o)),d=(W[o][l],s);i.push({year:Number(l),value:Number(d)})}}e[o]=i}}catch(p){n=!0,a=p}finally{try{t||null==c.return||c.return()}finally{if(n)throw a}}return e}(),a=J(),r=Object.values(n).reduce(function(e,t){return e.concat(t)},[]),o=function(e,t){return[g.m(e,t),g.l(e,t)]},i=g.p().domain(o(r,function(e){return e.year})).nice().range([0,e]),l=g.p().domain(o(r,function(e){return e.value})).nice().range([t,0]),u=V.map(function(e){return g.p().domain(o(T,function(t){return+t[e]})).nice().range([t,0])}),s=g.b(i).tickFormat(g.g("d")),d=g.c(l).tickFormat(g.g("~s")),p=g.k().x(function(e){return i(e.year)}).y(function(e){return l(e.value)}).curve(g.e);P.selectAll(".country").remove(),P.selectAll(".xAxis").remove(),P.selectAll(".yAxis").remove(),P.append("g").attr("class","xAxis").attr("transform","translate(0,".concat(t,")")).call(s),P.append("g").attr("class","yAxis").call(d);var f=c.a.get("isEmigration")?"emigration":"immigration",v=P.append("g").attr("class","countries");var h=0,m=function(e){var t=n[e],r=y.selection[h++%b],c=O(e);if(!t)return"break";var o=v.append("g").attr("id",e).attr("class","country").attr("name",c);if(o.append("path").datum(t).attr("class","line").attr("stroke",r).attr("d",p).on("click",function(){return e=o,v.attr("visibility","hidden"),e.attr("visibility","visible"),e.selectAll(".selected").classed("selected",!1),void e.selectAll(".metrics").classed("selected",!0);var e}).on("contextmenu",function(){return e=o,g.f.preventDefault(),v.attr("visibility","visible"),e.attr("visibility",null),e.selectAll(".selected").classed("selected",!1),void e.selectAll(".metrics").attr("visibility","hidden");var e}).on("mouseenter",function(){return o.selectAll(".metrics").attr("visibility","visible")}).on("mouseout",function(){return o.selectAll(".metrics").attr("visibility","hidden")}).append("title").text(function(){return"".concat(c," ").concat(f," line")}),o.append("g").attr("class","dots").attr("fill",r).attr("stroke",r).selectAll().data(t).enter().append("circle").attr("cx",function(e){return i(e.year)}).attr("cy",function(e){return l(e.value)}).attr("r",3).append("title").text(function(e){return"".concat(c," (").concat(e.year,"): ").concat(g.g("~s")(e.value))}),!a[e])return"break";var s=o.append("g").attr("class","metrics").attr("visibility","hidden");V.forEach(function(t,n){var r=g.j(n/V.length),o=g.k().x(function(e){return i(e.year)}).y(function(e){return u[n](e[t])}).defined(function(e){return e[t]}).curve(g.e),l=s.append("g").attr("class","metric");l.append("path").datum(a[e]).attr("stroke",r).attr("fill","none").attr("opacity",.8).attr("d",o).append("title").text(function(){return t}),l.append("g").attr("fill",r).attr("stroke",r).selectAll("circle").data(a[e]).enter().append("circle").attr("class","circle").attr("cx",function(e){return i(e.year)}).attr("cy",function(e){return u[n](e[t])}).attr("r",function(e){return""===e[t]?0:3}).append("title").text(function(e){return"".concat(c," (").concat(e.year,"): ").concat(e[t]," ").concat(t)})})};for(var x in n){if("break"===m(x))break}}var U,z,G,K={draw:function(e,t,n,a){var r=document.querySelector(e),c=[r.clientWidth,r.clientHeight],o=c[0],i=c[1];U=w(e,{width:o,height:i}),z=n,G=a;var l=g.h().scale(o/5).translate([o/2,i/.8]),u=g.i().projection(l),s=g.w().scaleExtent([.6,7]).on("zoom",function(){d.selectAll("path").attr("transform",g.f.transform)});U.call(s);var d=U.append("g").attr("class","countries");d.selectAll("path").data(t.features).enter().append("path").attr("id",function(e){return e.id}).attr("name",function(e){return e.properties.name}).attr("d",u).on("click",Z).on("mouseover",Q).on("mouseout",X).on("contextmenu",Y).append("title").text(function(e){return"".concat(e.id,": ").concat(e.properties.name)}),$()},update:$};function Q(){}function X(){}function Y(e){g.f.preventDefault();var t=new Set(c.a.get("selectedCountries"));t.delete(e.id),c.a.set("selectedCountries",Array.from(t)),$()}function Z(e){if(!["UNK","TWN","ATA"].includes(e.id)){var t=new Set(c.a.get("selectedCountries"));t.add(e.id),c.a.set("selectedCountries",Array.from(t)),$()}}function $(){console.log("updating map...");var e=c.a.get("selectedCountries")||[],t=c.a.get("year")||2010,n=z[t];function a(e){return void 0===n[e.id]?0:j(n,e.id)/G[e.id][t]||0}var r=g.r().domain([-20,-10,-5,-2.5,0,2.5,5,10,20]).range(y.map);U.selectAll("path").style("fill",function(e){return r(a(e))}).select("title").text(function(e){return"".concat(O(e.id),": ").concat(g.g(".1f")(a(e)),"/1000 population")}),g.v(".selected").classed("selected",!1),e.forEach(function(e,t){g.u("path#"+e).style("fill",y.selection[t%b]).classed("selected",!0)}),q.update(),F.update()}n(172),n(174),n(176);var _={1995:"1995",2000:"2000",2005:"2005",2010:"2010",2015:"2015",2017:"2017"};function ee(e){c.a.set("year",e),K.update()}var te=function(e){function t(){return Object(d.a)(this,t),Object(f.a)(this,Object(v.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{style:{padding:"0.4em 2em 0"}},i.a.createElement(m.a,{min:1995,max:2017,included:!1,marks:_,step:null,onChange:ee,defaultValue:2010,handleStyle:{border:"white",backgroundColor:"silver"}}))}}]),t}(i.a.PureComponent),ne=n(36),ae=n(49),re=n(51),ce=n.n(re),oe=function(e){function t(){return Object(d.a)(this,t),Object(f.a)(this,Object(v.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this.props.events,t=[];return e.forEach(function(e,n){t.push({value:n,label:e.name})}),i.a.createElement(ae.a,Object.assign({onChange:function(t){var n=e[t.value],a=n.name,r=n.year,o=n.countries.split(",");console.log(r,a,o),c.a.set("selectedCountries",o),K.update()},placeholder:"Select an event...",components:ce.a,onBlurResetsInput:!1,onSelectResetsInput:!1,onCloseResetsInput:!1,options:t,theme:function(e){return Object(ne.a)({},e,{borderRadius:0,colors:Object(ne.a)({},e.colors,{neutral0:"#333",neutral5:"orange",neutral10:"#666",neutral20:"#666",primary25:"#666",neutral50:"#eee",neutral80:"white"})})}},this.props))}}]),t}(i.a.PureComponent),ie=function(e){function t(){return Object(d.a)(this,t),Object(f.a)(this,Object(v.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this.props.data,t=c.a.get("codeToName"),n=[],a=Object.keys(e).slice(-1);Object.keys(e[a]).forEach(function(e){3===e.length&&n.push({value:e,label:t[e]})});var r=n.sort(function(e,t){return e.label<t.label?-1:1});return i.a.createElement(ae.a,Object.assign({isMulti:!0,placeholder:"Select countries...",components:ce.a,onBlurResetsInput:!1,onSelectResetsInput:!1,onCloseResetsInput:!1,options:r,theme:function(e){return Object(ne.a)({},e,{borderRadius:0,colors:Object(ne.a)({},e.colors,{neutral0:"#333",neutral5:"orange",neutral10:"#666",neutral20:"#666",primary25:"#666",neutral50:"#eee",neutral80:"white"})})},onChange:function(e,t){console.log(t);var n=new Set(c.a.get("selectedCountries"));switch(console.log(n),t.action){case"clear":n.clear();break;case"select-option":n.add(t.option.value);break;case"remove-value":console.log(t.removedValue.value),n.delete(t.removedValue.value);break;case"set-value":console.log("wut, is possibru?")}console.log(n),c.a.set("selectedCountries",Array.from(n)),K.update()}},this.props))}}]),t}(i.a.PureComponent),le=n(39),ue=n(99),se=n.n(ue),de=function(e){function t(e){var n;return Object(d.a)(this,t),(n=Object(f.a)(this,Object(v.a)(t).call(this,e))).state={checked:!1},n.handleChange=n.handleChange.bind(Object(le.a)(Object(le.a)(n))),n}return Object(h.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){var e=this.state.checked;c.a.set("isEmigration",e)}},{key:"handleChange",value:function(e){c.a.set("isEmigration",e),this.setState({checked:e}),K.update()}},{key:"render",value:function(){var e=this.state.checked;return i.a.createElement("div",null,i.a.createElement(se.a,{onChange:this.handleChange,checked:e,onColor:"#FFAB91",offColor:"#FFAB91",onHandleColor:"#FF8A65",offHandleColor:"#FF8A65",handleDiameter:24,uncheckedIcon:!1,checkedIcon:!1,boxShadow:"0px 1px 5px rgba(0, 0, 0, 0.6)",activeBoxShadow:"0px 0px 1px 10px rgba(0, 0, 0, 0.2)",height:16,width:64,id:"mySwitcherino"}),i.a.createElement("span",null,e?"Emigration":"Immigration"))}}]),t}(i.a.Component);n(200);c.a.remove("selectedCountries"),c.a.remove("isEmigration"),c.a.set("selectedCountries",["PRT","ESP","FRA","DEU"]);var pe=[Object(s.a)("./data/topology.json"),Object(s.a)("./data/migrations.json"),Object(s.b)("./data/conversion.tsv"),Object(s.b)("./data/population.tsv"),Object(s.b)("./data/events.tsv"),Object(s.b)("./data/whr2018.tsv")];Promise.all(pe).then(function(e){return function(e){var t=Object(a.a)(e,6),n=t[0],r=t[1],o=t[2],l=t[3],s=t[4],d=t[5],p=function(e){function t(e,t){var n=e.indexOf(t);return n>0?e[n-1]:e[0]}var n={},a=Object.keys(e);for(var r in e)if(r!==a[0])for(var c in n[r]={},e[r])for(var o in n[r][c]={},e[r][c]){var i=e[r][c],l=e[t(a,r)][c]||{};n[r][c][o]=i[o]-(l[o]||0)}return n}(r),f={},v={},h={};l.forEach(function(e){return v[e.Country]=x(e)}),d.forEach(function(e){return h[e.country]=x(e)}),o.forEach(function(e){return f[e.code3]=e.name}),c.a.set("codeToName",f),F.draw("#chord",r),q.draw("#graph",p,d,v),K.draw("#map",n,p,v),console.log(s),u.a.render(i.a.createElement(ie,{data:r}),k("countrySelect")),u.a.render(i.a.createElement(oe,{events:s}),k("eventList")),u.a.render(i.a.createElement(de,null),k("migrationSwitch")),u.a.render(i.a.createElement(te,null),k("yearSlider"))}(e)})}},[[102,2,1]]]);
//# sourceMappingURL=main.335303df.chunk.js.map