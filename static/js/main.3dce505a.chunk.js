(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{102:function(t,e,n){t.exports=n(200)},196:function(t,e,n){},198:function(t,e,n){},200:function(t,e,n){"use strict";n.r(e);var a=n(39),r=n(9),o=n.n(r),c=n(1),i=n.n(c),u=n(8),l=n.n(u),s=n(19),d=n(28),p=n(29),f=n(33),h=n(30),g=n(34),m=n(100),v=n(2);function y(t){var e={};for(var n in t)isNaN(t[n])||(e[n]=Number(t[n]));return e}function x(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{width:400,height:400},n=arguments.length>2?arguments[2]:void 0,a=Object(v.w)(t).append("svg").attr("width",e.width).attr("height",e.height);return void 0!==n?a.append("g").attr("class","main").attr("transform","translate(".concat(n.left||0,",").concat(n.top||0,")")):a}var b,w,j,E,O,k={draw:function(t,e,n,a){b=x(t,{width:e,height:n}),j=a,E=.5*Math.min(e,n)-30,O=E-20,b.attr("viewBox",[-e/2,-n/2,e,n]),b.append("g").attr("class","nodes"),b.append("g").attr("class","arcs").attr("fill-opacity",.8),A()},update:A};function A(){console.log("updating chord...");var t=b.select(".nodes"),e=b.select(".arcs");t.selectAll(".node").remove(),e.selectAll(".arc").remove();var n=v.d().padAngle(.04).sortSubgroups(v.f)(function(t){w=o.a.get("selectedCountries")||["PRT","DEU","BRA","ESP","SWE","ITA"];var e=o.a.get("isEmigration"),n=o.a.get("year")||2010,a=[];return console.log(e),w.forEach(function(r){a.push(w.map(function(a){return e?t[n][a][r]:t[n][r][a]}))}),a}(j)),r=v.p().radius(O),c=v.r().domain(v.n(9)).range(v.v[9]),i=v.a().innerRadius(O).outerRadius(E);t.selectAll("g").data(n.groups).enter().append("g").attr("class","node").append("path").attr("fill",function(t){return c(t.index)}).attr("stroke",function(t){return c(t.index)}).attr("d",i).append("title").text(function(t){return"".concat(w[t.index],": ").concat(v.h("~s")(t.value))}),e.selectAll("path").data(n).enter().append("path").attr("class","arc").attr("d",r).attr("fill",function(t){return c(t.target.index)}).attr("stroke",function(t){return v.o(c(t.target.index)).darker()}).append("title").text(function(t){var e=o.a.get("isEmigration")?[t.source,t.target]:[t.target,t.source],n=[t.source,t.target],r=e.map(function(t){return w[t.index]}),c=Object(a.a)(r,2),i=c[0],u=c[1],l=n.map(function(t){return v.h("~s")(t.value)}),s=Object(a.a)(l,2),d=s[0],p=s[1];return"".concat(i," > ").concat(u,": ").concat(d,"\n").concat(u," > ").concat(i,": ").concat(p)})}var C,S,R,I={draw:function(t,e,n,a){S={width:e,height:n},C=x(t,{width:e,height:n},N),R=a,T()},update:T},N={top:10,right:20,bottom:20,left:40};function T(){console.log("updating plot...");var t=S.width-N.left-N.right,e=S.height-N.top-N.bottom,n=R.reduce(function(t,e){return t.concat(e)},[]),a=function(t,e){return[v.m(t,e),v.l(t,e)]},r=v.q().domain(a(n,function(t){return t.x})).nice().range([0,t]),o=v.q().domain(a(n,function(t){return t.y})).nice().range([e,0]),c=v.b(r).tickFormat(v.h("d")),i=v.c(o).tickFormat(v.h("~s"));C.selectAll(".circle").remove(),C.append("g").attr("class","xAxis").attr("transform","translate(0,".concat(e,")")).call(c),C.append("g").attr("class","yAxis").call(i),C.append("g").attr("class","circles").selectAll("circle").data(R).enter().append("circle").attr("class","circle").attr("cx",function(t){return t.x}).attr("cy",function(t){return t.y}).attr("r",4)}var B,P,D,W,q={draw:function(t,e,n,a,r){P={width:e,height:n},B=x(t,{width:e,height:n},F),D=a,W=r,U()},update:U},F={top:10,right:20,bottom:20,left:40};function U(){console.log("updating lines...");var t=P.width-F.left-F.right,e=P.height-F.top-F.bottom,n=function(){var t=[],e=o.a.get("selectedCountries");if(!e||0===e.length)return[];var n=o.a.get("isEmigration"),a=!0,r=!1,c=void 0;try{for(var i,u=e[Symbol.iterator]();!(a=(i=u.next()).done);a=!0){var l=i.value,s=[];for(var d in D){var p=D[d];if(void 0!==p[l]){var f=Number(n?p.WORLD[l]:p[l].Total),h=(W[l][d],f);s.push({year:Number(d),value:Number(h)})}}t.push(s)}}catch(g){r=!0,c=g}finally{try{a||null==u.return||u.return()}finally{if(r)throw c}}return t}(),a=n.reduce(function(t,e){return t.concat(e)},[]),r=function(t,e){return[v.m(t,e),v.l(t,e)]},c=v.q().domain(r(a,function(t){return t.year})).nice().range([0,t]),i=v.q().domain(r(a,function(t){return t.value})).nice().range([e,0]),u=v.b(c).tickFormat(v.h("d")),l=v.c(i).tickFormat(v.h("~s")),s=v.k().x(function(t){return c(t.year)}).y(function(t){return i(t.value)}).curve(v.e);B.selectAll(".dots").remove(),B.selectAll(".line").remove(),B.select(".xAxis").remove(),B.select(".yAxis").remove(),B.append("g").attr("class","xAxis").attr("transform","translate(0,".concat(e,")")).call(u),B.append("g").attr("class","yAxis").call(l);for(var d=0;d<n.length;d++){var p=v.u[6][d%6];B.append("path").datum(n[d]).attr("stroke",p).attr("class","line").attr("d",s),B.append("g").attr("class","dots").attr("fill",p).attr("stroke",p).selectAll().data(n[d]).enter().append("circle").attr("cx",function(t){return c(t.year)}).attr("cy",function(t){return i(t.value)}).attr("r",5)}}var J,K,L,M={draw:function(t,e,n,a,r,o){J=x(t,{width:e,height:n}),K=r,L=o;var c=v.i().scale(e/4).translate([e/2,n/1.2]),i=v.j().projection(c),u=v.y().scaleExtent([.6,7]).on("zoom",function(){l.selectAll("path").attr("transform",v.g.transform)});J.call(u);var l=J.append("g").attr("class","countries");l.selectAll("path").data(a.features).enter().append("path").attr("id",function(t){return t.id}).attr("name",function(t){return t.properties.name}).attr("d",i).on("click",G).on("mouseover",z).on("mouseout",H).on("contextmenu",V).append("title").text(function(t){return"".concat(t.id,": ").concat(t.properties.name)}),X()},update:X};function z(){}function H(){}function V(t){v.g.preventDefault();var e=new Set(o.a.get("selectedCountries"));e.delete(t.id),o.a.set("selectedCountries",Array.from(e)),X()}function G(t){if(!["UNK","TWN","ATA"].includes(t.id)){var e=new Set(o.a.get("selectedCountries"));e.add(t.id),o.a.set("selectedCountries",Array.from(e)),X()}}var Q=v.s().domain([1,10,100,250,500,1e3,2500,5e3,1e4].map(function(t){return 1e3*t})).range(v.t[9]);function X(){console.log("updating map...");var t=o.a.get("selectedCountries")||[],e=v.u[6];v.x(".selected").classed("selected",!1),t.forEach(function(t,n){v.w("path#"+t).style("fill",e[n%6]).classed("selected",!0)});var n=o.a.get("year")||2010,a=o.a.get("isEmigration");J.selectAll("path:not(.selected)").style("fill",function(t){var e=K[n];if(void 0===e[t.id])return"black";var r=Number(a?e.WORLD[t.id]:e[t.id].Total);L[t.id][n];return Q(r)}),q.update(),k.update()}n(172);var Y={1995:"1995",2000:"2000",2005:"2005",2010:"2010",2015:"2015",2017:"2017"};function Z(t){console.log(t),o.a.set("year",t),M.update()}var $=function(t){function e(){return Object(d.a)(this,e),Object(f.a)(this,Object(h.a)(e).apply(this,arguments))}return Object(g.a)(e,t),Object(p.a)(e,[{key:"render",value:function(){return i.a.createElement("div",{style:{padding:"0.6em 2em 0"}},i.a.createElement(m.a,{min:1995,max:2017,marks:Y,step:null,onChange:Z,defaultValue:2010}))}}]),e}(i.a.PureComponent),_=n(68),tt=n(96),et=n(98),nt=n.n(et),at=function(t){function e(){return Object(d.a)(this,e),Object(f.a)(this,Object(h.a)(e).apply(this,arguments))}return Object(g.a)(e,t),Object(p.a)(e,[{key:"render",value:function(){var t=this.props.countries.sort(function(t,e){return t.label<e.label?-1:1});return i.a.createElement(tt.a,Object.assign({isMulti:!0,placeholder:"Select countries...",components:nt.a,onBlurResetsInput:!1,onSelectResetsInput:!1,onCloseResetsInput:!1,options:t,theme:function(t){return Object(_.a)({},t,{borderRadius:0,colors:Object(_.a)({},t.colors,{neutral0:"#333",neutral5:"orange",neutral10:"#666",neutral20:"#666",primary25:"#666",neutral50:"#eee",neutral80:"white"})})}},this.props))}}]),e}(i.a.PureComponent),rt=n(38),ot=n(99),ct=n.n(ot),it=function(t){function e(t){var n;return Object(d.a)(this,e),(n=Object(f.a)(this,Object(h.a)(e).call(this,t))).state={checked:!1},n.handleChange=n.handleChange.bind(Object(rt.a)(Object(rt.a)(n))),n}return Object(g.a)(e,t),Object(p.a)(e,[{key:"handleChange",value:function(t){o.a.set("isEmigration",t),this.setState({checked:t}),M.update(),q.update(),k.update()}},{key:"render",value:function(){var t=this.state.checked;return i.a.createElement("div",null,i.a.createElement(ct.a,{onChange:this.handleChange,checked:t,onColor:"#86d3ff",onHandleColor:"#2693e6",handleDiameter:24,uncheckedIcon:!1,checkedIcon:!1,boxShadow:"0px 1px 5px rgba(0, 0, 0, 0.6)",activeBoxShadow:"0px 0px 1px 10px rgba(0, 0, 0, 0.2)",height:16,width:64,id:"mySwitcherino"}),i.a.createElement("span",null,t?"Emigration":"Immigration"))}}]),e}(i.a.Component);n(196),n(198);o.a.remove("selectedCountries"),o.a.remove("isEmigration"),o.a.set("selectedCountries",["PRT","SWE","UKR"]);var ut=[{x:21,y:110},{x:22.8,y:93},{x:18.7,y:175},{x:14.3,y:245},{x:24.4,y:62},{x:14.7,y:230},{x:32.4,y:66},{x:30.4,y:52},{x:33.9,y:65},{x:15.5,y:150},{x:15.2,y:150},{x:13.3,y:245},{x:19.2,y:175},{x:27.3,y:66},{x:26,y:91},{x:30.4,y:113},{x:15.8,y:264},{x:19.7,y:175},{x:15,y:335},{x:21.4,y:109}],lt=[1990,1995,2e3,2005,2010,2015,2017];function st(t){var e=new Set(o.a.get("selectedCountries"));t.forEach(function(t){return e.add(t.value)}),o.a.set("selectedCountries",Array.from(e)),M.update()}Promise.all(lt.map(function(t){return Object(s.b)("./data/migration/".concat(t,".tsv"))})).then(function(t){var e={};t.forEach(function(t,n){e[lt[n]]={},t.forEach(function(t){return e[lt[n]][t.Country]=y(t)})}),console.log(e),Promise.all([Object(s.a)("./data/topology.json"),Object(s.b)("./data/conversion.tsv"),Object(s.b)("./data/population.tsv"),Object(s.b)("./data/whr2017.tsv")]).then(function(t){!function(t,e){var n=Object(a.a)(t,4),r=n[0],c=n[1],u=n[2],s=n[3],d={},p={},f={};u.forEach(function(t){return p[t.Country]=y(t)}),s.forEach(function(t){return f[t.country]=y(t)}),c.forEach(function(t){return d[t.code3]=t.name}),o.a.set("codeToName",d),k.draw("#chord",600,420,e),I.draw("#plot",600,420,ut),q.draw("#lines",1e3,420,e,p),M.draw("#map",1e3,420,r,e,p),l.a.render(function(t,e,n){var a=[];return Object.keys(t[2e3]).forEach(function(t){3===t.length&&a.push({value:t,label:e[t]})}),i.a.createElement(at,{value:n,countries:a,onChange:st})}(e,d),document.getElementById("countrySelect")),l.a.render(i.a.createElement(it,null),document.getElementById("migrationSwitch")),l.a.render(i.a.createElement($,null),document.getElementById("yearSlider"))}(t,e)})})}},[[102,2,1]]]);
//# sourceMappingURL=main.3dce505a.chunk.js.map