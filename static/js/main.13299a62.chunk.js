(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{102:function(t,e,n){t.exports=n(200)},196:function(t,e,n){},198:function(t,e,n){},200:function(t,e,n){"use strict";n.r(e);var a=n(101),r=n(10),o=n.n(r),c=n(1),i=n.n(c),u=n(8),l=n.n(u),s=n(19),d=n(28),f=n(29),p=n(33),m=n(30),h=n(34),g=n(99),v=n(2);function y(t){var e={};for(var n in t)isNaN(t[n])||(e[n]=Number(t[n]));return e}function x(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{width:400,height:400},n=arguments.length>2?arguments[2]:void 0,a=Object(v.A)(t).append("svg").attr("width",e.width).attr("height",e.height);return void 0!==n?a.append("g").attr("class","main").attr("transform","translate(".concat(n.left||0,",").concat(n.top||0,")")):a}var b,w={draw:function(t,e,n,a){b=x(t,{width:e,height:n});var r=.5*Math.min(e,n)-30,o=r-20;b.attr("viewBox",[-e/2,-n/2,e,n]).attr("font-size",10).attr("font-family","sans-serif");var c=v.d().padAngle(.05).sortSubgroups(v.f)(a),i=v.u().radius(o),u=v.m(",.0",1e3),l=v.w().domain(v.s(4)).range(["#c6dbef","#6baed6","#2171b5","#08306b"]),s=v.a().innerRadius(o).outerRadius(r),d=b.append("g").selectAll("g").data(c.groups).enter().append("g");d.append("path").attr("fill",function(t){return l(t.index)}).attr("stroke",function(t){return v.t(l(t.index)).darker()}).attr("d",s);var f=d.append("g").selectAll("g").data(function(t){return function(t,e){var n=(t.endAngle-t.startAngle)/t.value;return v.s(0,t.value,e).map(function(e){return{value:e,angle:e*n+t.startAngle}})}(t,1e3)}).enter().append("g").attr("transform",function(t){return"rotate(".concat(180*t.angle/Math.PI-90,") translate(").concat(r,",0)")});f.append("line").attr("stroke","#000").attr("x2",6),f.filter(function(t){return t.value%5e3===0}).append("text").attr("x",8).attr("dy",".35em").attr("transform",function(t){return t.angle>Math.PI?"rotate(180) translate(-16)":null}).attr("text-anchor",function(t){return t.angle>Math.PI?"end":null}).text(function(t){return u(t.value)}),b.append("g").attr("fill-opacity",.67).selectAll("path").data(c).enter().append("path").attr("d",i).attr("fill",function(t){return l(t.target.index)}).attr("stroke",function(t){return v.t(l(t.target.index)).darker()})},update:function(t,e){}};var j,O={draw:function(t,e,n,a){j=x(t,{width:e,height:n});var r={top:20,right:20,bottom:30,left:40},o=v.v().domain(v.h(a,function(t){return t.x})).nice().range([r.left,e-r.right]),c=v.v().domain(v.h(a,function(t){return t.y})).nice().range([n-r.bottom,r.top]);j.append("g").attr("class","axis-x").call(function(t){t.attr("transform","translate(0,".concat(n-r.bottom,")")).call(v.b(o)).call(function(t){return t.select(".domain").remove()})}),j.append("g").attr("class","axis-y").call(function(t){t.attr("transform","translate(".concat(r.left,",0)")).call(v.c(c)).call(function(t){return t.select(".domain").remove()}).call(function(t){return t.select(".tick:last-of-type text").clone()})}),j.append("g").attr("class","circles").selectAll("circle").data(a).enter().append("circle").attr("cx",function(t){return o(t.x)}).attr("cy",function(t){return c(t.y)}).attr("r",4),j.append("g").attr("class","text").selectAll("text").data(a).enter().append("text").attr("x",function(t){return o(t.x)}).attr("y",function(t){return c(t.y)}).text(function(t){return t.name}).call(function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:300,n=t.nodes(),a=function(t){return t.attr("text-anchor","start").attr("dy","0.32em")},r=function(t){return t.attr("text-anchor","end").attr("dy","0.32em")},o=function(t){return t.attr("text-anchor","middle").attr("dy","0.0em")},c=function(t){return t.attr("text-anchor","middle").attr("dy","0.8em")},i=n.map(function(t){return{fx:+t.getAttribute("x"),fy:+t.getAttribute("y")}}),u=i.map(function(t){var e=t.fx,n=t.fy;return{x:e,y:n}}),l=i.map(function(t,e){return{source:t,target:u[e]}}),s=v.k(i.concat(u)).force("charge",v.j().distanceMax(80)).force("link",v.i(l).distance(4).iterations(4)).stop(),d=0;d<e;++d)s.tick();t.attr("x",function(t,e){return u[e].x}).attr("y",function(t,e){return u[e].y}).each(function(t,e){var n=Math.atan2(u[e].y-i[e].fy,u[e].x-i[e].fx);v.A(this).call(n>Math.PI/4&&n<=3*Math.PI/4?c:n>-Math.PI/4&&n<=Math.PI/4?a:n>3*-Math.PI/4&&n<=3*Math.PI/4?o:r)})})},update:function(t,e){}};var k,A,E,C,I={draw:function(t,e,n,a,r){A={width:e,height:n},k=x(t,{width:e,height:n},S),E=a,C=r,M()},update:M},S={top:10,right:20,bottom:20,left:40};function M(){var t=A.width-S.left-S.right,e=A.height-S.top-S.bottom,n=function(){var t=[],e=o.a.get("selectedCountries");if(!e||0===e.length)return[];var n=o.a.get("isEmigration"),a=!0,r=!1,c=void 0;try{for(var i,u=e[Symbol.iterator]();!(a=(i=u.next()).done);a=!0){var l=i.value,s=[];for(var d in E){var f=E[d];if(void 0!==f[l]){var p=Number(n?f.WORLD[l]:f[l].Total),m=(C[l][d],p);s.push({year:Number(d),value:Number(m)})}}t.push(s)}}catch(h){r=!0,c=h}finally{try{a||null==u.return||u.return()}finally{if(r)throw c}}return t}(),a=n.reduce(function(t,e){return t.concat(e)},[]),r=function(t,e){return[v.r(t,e),v.q(t,e)]},c=v.v().domain(r(a,function(t){return t.year})).nice().range([0,t]),i=v.v().domain(r(a,function(t){return t.value})).nice().range([e,0]),u=v.b(c).tickFormat(v.l("d")),l=v.c(i).tickFormat(v.l("~s")),s=v.p().x(function(t){return c(t.year)}).y(function(t){return i(t.value)}).curve(v.e);k.selectAll(".dots").remove(),k.selectAll(".line").remove(),k.select(".xAxis").remove(),k.select(".yAxis").remove(),k.append("g").attr("class","xAxis").attr("transform","translate(0,".concat(e,")")).call(u),k.append("g").attr("class","yAxis").call(l);for(var d=0;d<n.length;d++){var f=v.z[6][d%6];k.append("path").datum(n[d]).attr("stroke",f).attr("class","line").attr("d",s),k.append("g").attr("class","dots").attr("fill",f).attr("stroke",f).selectAll().data(n[d]).enter().append("circle").attr("cx",function(t){return c(t.year)}).attr("cy",function(t){return i(t.value)}).attr("r",5)}}var P,N,R={draw:function(t,e,n,a,r,o){P=x(t,{width:e,height:n}),N=r,o;var c=v.n().scale(e/4).translate([e/2,n/1.2]),i=v.o().projection(c),u=v.C().scaleExtent([.6,7]).on("zoom",function(){l.selectAll("path").attr("transform",v.g.transform)});P.call(u);var l=P.append("g").attr("class","countries");l.selectAll("path").data(a.features).enter().append("path").attr("id",function(t){return t.id}).attr("name",function(t){return t.properties.name}).attr("d",i).on("click",T).on("mouseover",B).on("mouseout",D).on("contextmenu",z).append("title").text(function(t){return"".concat(t.id,": ").concat(t.properties.name)}),J()},update:J};function B(){}function D(){}function z(t){v.g.preventDefault();var e=new Set(o.a.get("selectedCountries"));e.delete(t.id),o.a.set("selectedCountries",Array.from(e)),J()}function T(t){var e=new Set(o.a.get("selectedCountries"));e.add(t.id),o.a.set("selectedCountries",Array.from(e)),J()}var F=v.x().domain([1,10,100,250,500,1e3,2500,5e3,1e4].map(function(t){return 1e3*t})).range(v.y[9]);function J(){var t=o.a.get("selectedCountries")||[],e=v.z[6];v.B(".selected").classed("selected",!1),t.forEach(function(t,n){v.A("path#"+t).style("fill",e[n%6]).classed("selected",!0)});var n=o.a.get("year")||2010,a=o.a.get("isEmigration");P.selectAll("path:not(.selected)").style("fill",function(t){var e=N[n];if(void 0===e[t.id])return"black";var r=Number(a?e.WORLD[t.id]:e[t.id].Total);return F(r)}),I.update()}n(172);var L={1990:"1990",1995:"1995",2000:"2000",2005:"2005",2010:"2010",2015:"2015",2017:"2017"};function H(t){console.log(t),o.a.set("year",t),R.update()}var W=function(t){function e(){return Object(d.a)(this,e),Object(p.a)(this,Object(m.a)(e).apply(this,arguments))}return Object(h.a)(e,t),Object(f.a)(e,[{key:"render",value:function(){return i.a.createElement("div",{style:{padding:"0.6em 2em 0"}},i.a.createElement(g.a,{min:1990,max:2017,marks:L,step:null,onChange:H,defaultValue:2005}))}}]),e}(i.a.PureComponent),q=n(67),G=n(95),K=n(97),Q=n.n(K),V=function(t){function e(){return Object(d.a)(this,e),Object(p.a)(this,Object(m.a)(e).apply(this,arguments))}return Object(h.a)(e,t),Object(f.a)(e,[{key:"render",value:function(){var t=this.props.countries.sort(function(t,e){return t.label<e.label?-1:1});return i.a.createElement(G.a,Object.assign({isMulti:!0,placeholder:"Select countries...",components:Q.a,onBlurResetsInput:!1,onSelectResetsInput:!1,onCloseResetsInput:!1,options:t,theme:function(t){return Object(q.a)({},t,{borderRadius:0,colors:Object(q.a)({},t.colors,{neutral0:"#333",neutral5:"orange",neutral10:"#666",neutral20:"#666",primary25:"#666",neutral50:"#eee",neutral80:"white"})})}},this.props))}}]),e}(i.a.PureComponent),U=n(38),X=n(98),Y=n.n(X),Z=function(t){function e(t){var n;return Object(d.a)(this,e),(n=Object(p.a)(this,Object(m.a)(e).call(this,t))).state={checked:!1},n.handleChange=n.handleChange.bind(Object(U.a)(Object(U.a)(n))),n}return Object(h.a)(e,t),Object(f.a)(e,[{key:"handleChange",value:function(t){o.a.set("isEmigration",t),this.setState({checked:t}),R.update(),I.update()}},{key:"render",value:function(){var t=this.state.checked;return i.a.createElement("div",null,i.a.createElement(Y.a,{onChange:this.handleChange,checked:t,onColor:"#86d3ff",onHandleColor:"#2693e6",handleDiameter:24,uncheckedIcon:!1,checkedIcon:!1,boxShadow:"0px 1px 5px rgba(0, 0, 0, 0.6)",activeBoxShadow:"0px 0px 1px 10px rgba(0, 0, 0, 0.2)",height:16,width:64,id:"mySwitcherino"}),i.a.createElement("span",null,t?"Emigration":"Immigration"))}}]),e}(i.a.Component);n(196),n(198);o.a.remove("selectedCountries"),o.a.remove("isEmigration");var $=[[16,16,13,12,0,6],[1,0,12,10,6,1],[9,10,13,0,5,5],[15,1,14,16,9,16],[5,10,16,16,10,0],[9,8,2,13,13,9]],_=[{name:"A",x:21,y:110},{name:"B",x:22.8,y:93},{name:"C",x:18.7,y:175},{name:"D",x:14.3,y:245},{name:"E",x:24.4,y:62},{name:"F",x:14.7,y:230},{name:"G",x:32.4,y:66},{name:"H",x:30.4,y:52},{name:"I",x:33.9,y:65},{name:"J",x:15.5,y:150},{name:"K",x:15.2,y:150},{name:"L",x:13.3,y:245},{name:"M",x:19.2,y:175},{name:"N",x:27.3,y:66},{name:"O",x:26,y:91},{name:"P",x:30.4,y:113},{name:"Q",x:15.8,y:264},{name:"R",x:19.7,y:175},{name:"S",x:15,y:335},{name:"T",x:21.4,y:109}],tt=[1990,1995,2e3,2005,2010,2015,2017];function et(t){var e=new Set(o.a.get("selectedCountries"));t.forEach(function(t){return e.add(t.value)}),o.a.set("selectedCountries",Array.from(e)),R.update()}Promise.all(tt.map(function(t){return Object(s.b)("./data/migration/".concat(t,".tsv"))})).then(function(t){var e={};t.forEach(function(t,n){e[tt[n]]={},t.forEach(function(t){return e[tt[n]][t.Country]=t})}),Promise.all([Object(s.a)("./data/topology.json"),Object(s.b)("./data/conversion.tsv"),Object(s.b)("./data/population.tsv"),Object(s.b)("./data/whr2017.tsv")]).then(function(t){!function(t,e){var n=Object(a.a)(t,4),r=n[0],c=n[1],u=n[2],s=n[3],d={},f={},p={};u.forEach(function(t){return f[t.Country]=y(t)}),s.forEach(function(t){return p[t.country]=y(t)}),c.forEach(function(t){return d[t.code3]=t.name}),o.a.set("codeToName",d),O.draw("#plot",600,420,_),I.draw("#lines",1e3,420,e,f),R.draw("#map",1e3,420,r,e,f),w.draw("#chord",600,420,$),l.a.render(function(t,e,n){var a=[];return Object.keys(t[1990]).forEach(function(t){3===t.length&&a.push({value:t,label:e[t]})}),i.a.createElement(V,{value:n,countries:a,onChange:et})}(e,d),document.getElementById("countrySelect")),l.a.render(i.a.createElement(Z,null),document.getElementById("migrationSwitch")),l.a.render(i.a.createElement(W,null),document.getElementById("yearSlider"))}(t,e)})})}},[[102,2,1]]]);
//# sourceMappingURL=main.13299a62.chunk.js.map